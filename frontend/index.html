<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <title>MyLibrary</title>

  <!-- CSP: –¥–æ–∑–≤–æ–ª—è—î–º–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∑ https —ñ data:, –∑–∞–ø–∏—Ç–∏ –Ω–∞ –±–µ–∫ —ñ https,
       —Å—Ç–∏–ª—ñ –∑ —ñ–Ω–ª–∞–π–Ω–æ–º (–±–æ –≤ HTML —î style="‚Ä¶"), –∑–∞–±–æ—Ä–æ–Ω–∞ —ñ–Ω–ª–∞–π–Ω–æ–≤–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤ -->
  <meta http-equiv="Content-Security-Policy"
        content="
          default-src 'self';
          img-src 'self' data: https:;
          connect-src 'self' https:;
          style-src 'self' 'unsafe-inline';
          font-src 'self' data: https:;
          script-src 'self';
          script-src-attr 'none';
          object-src 'none';
          base-uri 'self';
        ">

  <link rel="stylesheet" href="style.css"/>
  <meta name="referrer" content="no-referrer" />
</head>
<body>
  <!-- Top bar -->
  <header class="topbar">
    <div class="container topbar__row">
      <div class="brand">
        <div class="brand__logo">üìö</div>
        <div class="brand__name">MyLibrary</div>
      </div>
      <nav class="nav">
        <a class="nav__link active">–ö–∞—Ç–∞–ª–æ–≥</a>
        <a class="nav__link">–ê–≤—Ç–æ—Ä–∏</a>
        <a class="nav__link">–£–ª—é–±–ª–µ–Ω–µ</a>
      </nav>
      <div class="profile">
        <button id="enrichBtn" class="btn ghost small">–ó–±–∞–≥–∞—á–µ–Ω–Ω—è</button>
        <button id="themeToggle" class="btn small">–¢–µ–º–∞</button>
      </div>
    </div>
  </header>

  <!-- Filters -->
  <section class="filters">
    <div class="container filters__row">
      <div class="filters__left">
        <div class="input search">
          <input id="searchInput" type="text" placeholder="–ü–æ—à—É–∫ –ø–æ –Ω–∞–∑–≤—ñ –∞–±–æ –∞–≤—Ç–æ—Ä—É..."/>
          <span class="search__icon">üîç</span>
        </div>
      </div>
      <div class="filters__right">
        <select id="statusSelect" class="select">
          <option value="">–°—Ç–∞—Ç—É—Å: –£—Å—ñ</option>
          <option value="PROCHYTANA">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ</option>
          <option value="PLANUYU">–ü–ª–∞–Ω—É—é</option>
        </select>
        <select id="sortSelect" class="select">
          <option value="-date">–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è: –ù–æ–≤—ñ</option>
          <option value="+date">–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è: –°—Ç–∞—Ä—ñ</option>
          <option value="+title">–ù–∞–∑–≤–∞ A‚Äì–Ø</option>
          <option value="-title">–ù–∞–∑–≤–∞ –Ø‚ÄìA</option>
        </select>
        <button id="addBtn" class="btn primary small">–î–æ–¥–∞—Ç–∏ –∫–Ω–∏–≥—É</button>
        <button id="importBtn" class="btn small">–Ü–º–ø–æ—Ä—Ç</button>
      </div>
    </div>
  </section>

  <!-- Counters -->
  <section class="container counters">
    –í—Å—å–æ–≥–æ: <span id="statTotal">0</span> ¬∑ –ü—Ä–æ—á–∏—Ç–∞–Ω–æ: <span id="statRead">0</span> ¬∑ –ü–ª–∞–Ω—É—é: <span id="statPlan">0</span>
  </section>

  <!-- Grid -->
  <main class="container">
    <div id="booksGrid" class="grid"></div>
    <p id="loadingMessage" class="muted">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è‚Ä¶</p>
  </main>

  <!-- External search (—á–µ—Ä–µ–∑ –±–µ–∫–µ–Ω–¥-–ø—Ä–æ–∫—Å—ñ /api/ext/search) -->
  <section id="externalSearch" class="container" style="margin-top:20px;">
    <div class="ext-box">
      <h3 style="margin:0 0 8px 0;">–ü–æ—à—É–∫ —É –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –±–∞–∑–∞—Ö</h3>
      <div class="ext-row">
        <input id="extQuery" type="text" class="ext-input" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –∫–Ω–∏–≥–∏ –∞–±–æ –ù–∞–∑–≤–∞ ‚Äî –ê–≤—Ç–æ—Ä"/>
        <button id="extSearchBtn" class="btn primary">–ó–Ω–∞–π—Ç–∏</button>
      </div>
      <div id="extResults" class="ext-grid"></div>
    </div>
  </section>

  <!-- Book modal -->
  <div id="modalBackdrop" class="modal-backdrop hidden"></div>
  <div id="bookModal" class="modal hidden">
    <div class="modal-card">
      <button id="modalClose" class="btn ghost small-x">‚úï</button>
      <div class="modal-cover" id="modalCover"></div>
      <div class="modal-content">
        <h3 id="modalTitle"></h3>
        <p class="modal-author" id="modalAuthor"></p>
        <p class="modal-meta" id="modalMeta"></p>
        <div class="modal-desc" id="modalDesc"></div>
      </div>
    </div>
  </div>

  <!-- Add Book Modal -->
  <div id="addModalBackdrop" class="modal-backdrop hidden"></div>
  <div id="addModal" class="modal hidden">
    <div class="modal-card" style="grid-template-columns:1fr;">
      <button id="addClose" class="btn ghost small-x">‚úï</button>
      <div class="modal-content">
        <h3>–î–æ–¥–∞—Ç–∏ –∫–Ω–∏–≥—É</h3>
        <form id="addForm" class="form-grid">
          <label>–ù–∞–∑–≤–∞
            <input type="text" id="addTitle" required />
          </label>
          <label>–ê–≤—Ç–æ—Ä
            <input type="text" id="addAuthor" required />
          </label>
          <label>–°—Ç–æ—Ä—ñ–Ω–æ–∫
            <input type="number" id="addPages" min="1" required />
          </label>
          <label>–°—Ç–∞—Ç—É—Å
            <select id="addStatus">
              <option value="PLANUYU">–ü–ª–∞–Ω—É—é</option>
              <option value="PROCHYTANA">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ</option>
            </select>
          </label>
          <label>ISBN (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)
            <input type="text" id="addIsbn" />
          </label>
          <label>–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –æ–±–∫–ª–∞–¥–∏–Ω–∫—É (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)
            <input type="url" id="addCover" />
          </label>
          <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:8px;">
            <button type="button" class="btn" id="addCancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
            <button type="submit" class="btn primary">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Import Modal -->
  <div id="importModalBackdrop" class="modal-backdrop hidden"></div>
  <div id="importModal" class="modal hidden">
    <div class="modal-card" style="grid-template-columns:1fr;">
      <button id="importClose" class="btn ghost small-x">‚úï</button>
      <div class="modal-content">
        <h3>–Ü–º–ø–æ—Ä—Ç —Å–ø–∏—Å–∫—É</h3>
        <p class="muted">–í—Å—Ç–∞–≤ —Å–ø–∏—Å–æ–∫ —É —Ñ–æ—Ä–º–∞—Ç—ñ: <code>–ù–∞–∑–≤–∞ ‚Äî –ê–≤—Ç–æ—Ä ‚Äî –°—Ç–æ—Ä—ñ–Ω–æ–∫ ‚Äî [STATUS]</code>, –ø–æ –æ–¥–Ω–æ–º—É –≤ —Ä—è–¥–æ–∫.</p>
        <textarea id="importText" rows="10" style="width:100%;"></textarea>
        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:8px;">
          <button class="btn" id="importCancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
          <button class="btn primary" id="importDo">–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏</button>
        </div>
      </div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <input id="hiddenFileInput" type="file" accept="image/png,image/jpeg,image/jpg,image/svg+xml" style="display:none" />

  <!-- –í–ê–ñ–õ–ò–í–û: –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Å–∫—Ä–∏–ø—Ç, –±–µ–∑ —ñ–Ω–ª–∞–π–Ω–æ–≤–∏—Ö –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤; defer —â–æ–± DOM —É–∂–µ —ñ—Å–Ω—É–≤–∞–≤ -->
  <script src="script.js" defer></script>
</body>
</html>
